{% extends "base.html" %}

{% block title %}{{ user.screen_name }}{% endblock %}

{% block content %}

<div class="user">
  <div class="user_meta">
    <h2>{{ voter.name }}</h2>
    <p class="subheading">
      <a href="{{ voter.twitter_url }}">
        @{{ voter.screen_name }}
      </a>
    </p>
    <p class="subheading">batting at {{ voter.batting_average }}</p>
    {% if voter.is_authenticated %}
      <p class="subheading"><a href="{% url toggle_abuse voter.id %}">
        {% if voter.is_abuser %}
          redeem {{ voter }}
        {% else %}
          condemn {{ voter }}
        {% endif %}
      </a></p>
    {% endif %}
    <p class="subheading">
      <a class="avatar" href="{{ voter.twitter_url }}">
        <img class="avatar" src="{{ voter.user_image }}" alt="{{ voter.name }}"></img>
      </a>
    </p>
  </div>

  <div class="user_votes">
    <h2>votes</h2>
    <ul>
      {% for vote in voter.votes %}
        <li class="vote">
          <p class="when"><a href="{{ vote.twitter_url }}">{{ vote.when }}</a></p>
          {% if vote.content %}
            <p class="content">‘{{ vote.content }}’</p>
          {% endif %}
          {% for track in vote.tracks.all %}
          <div class="vote_track">
            <p class="artist"><a href="/artist/{{ track.artist|urlencode }}/">{{ track.artist }}</a></p>
            <p class="title"><a href="{{ track.rel_url }}">{{ track.derived_title }}</a></p>
            {% if track.derived_role %}
              <p class="role">{{ track.derived_role }}</p>
            {% endif %}
          </div>
          {% endfor %}
        </div>
      {% endfor %}
    </ul>
  </div> <!-- user_votes -->
</div>

{% endblock %}
